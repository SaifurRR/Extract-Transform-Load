{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "f0be3aa1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'\\nAn input CSV file containing statistical information about diseases in \\ndifferent locations is given.\\n\\nHere are the definitions of each column in the input file:\\n\\n1. location_code: The unique identifier of the location\\n2. disease: Name of the disease\\n3. prevalence: Number of people having the disease\\n4. population: Number of people living in the location\\n\\nPlease complete the following Python function that:\\n(a) calculates the percentage of people who have each disease in each\\n    location, and\\n(b) writes the result to a specified CSV file\\n\\nNotes:\\n1. If there is no information about a disease for a specific location, \\n    the percentage should be considered zero.\\n2. The output file should contain a column specifying the location \\n   and a column for each disease.\\n3. The samples of input and output files have been attached.\\n'"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\"\"\"\n",
    "An input CSV file containing statistical information about diseases in \n",
    "different locations is given.\n",
    "\n",
    "Here are the definitions of each column in the input file:\n",
    "\n",
    "1. location_code: The unique identifier of the location\n",
    "2. disease: Name of the disease\n",
    "3. prevalence: Number of people having the disease\n",
    "4. population: Number of people living in the location\n",
    "\n",
    "Please complete the following Python function that:\n",
    "(a) calculates the percentage of people who have each disease in each\n",
    "    location, and\n",
    "(b) writes the result to a specified CSV file\n",
    "\n",
    "Notes:\n",
    "1. If there is no information about a disease for a specific location, \n",
    "    the percentage should be considered zero.\n",
    "2. The output file should contain a column specifying the location \n",
    "   and a column for each disease.\n",
    "3. The samples of input and output files have been attached.\n",
    "\"\"\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "8870cc1a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>location_code</th>\n",
       "      <th>disease</th>\n",
       "      <th>prevalence</th>\n",
       "      <th>population</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>1277</td>\n",
       "      <td>18063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>1344</td>\n",
       "      <td>11123</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>603</td>\n",
       "      <td>11545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>12</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>1265</td>\n",
       "      <td>19140</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>6</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>1943</td>\n",
       "      <td>11811</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   location_code   disease  prevalence  population\n",
       "0              1  diabetes        1277       18063\n",
       "1              2  diabetes        1344       11123\n",
       "2              4  diabetes         603       11545\n",
       "3             12  diabetes        1265       19140\n",
       "4              6  diabetes        1943       11811"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import sys\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import csv\n",
    "data = pd.read_csv('input.csv')\n",
    "data.head(5)\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "c31b99f7",
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax (Temp/ipykernel_5532/3248096761.py, line 5)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  File \u001b[1;32m\"C:\\Users\\saif08.stu\\AppData\\Local\\Temp/ipykernel_5532/3248096761.py\"\u001b[1;36m, line \u001b[1;32m5\u001b[0m\n\u001b[1;33m    percentage_calc=\u001b[0m\n\u001b[1;37m                     ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m invalid syntax\n"
     ]
    }
   ],
   "source": [
    "def calculate_prevalence_rate_by_location(input_path: str, output_path: str) -> None:\n",
    "    #pass: used for future task\n",
    "    #problem_1 = data.groupby('location_code')['location_code'].count()\n",
    "    #print(problem_1) \n",
    "     percentage_calc= \n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4b090714",
   "metadata": {},
   "outputs": [],
   "source": [
    "if __name__ == '__main__': #checks whether code is run from the main file or imported file\n",
    "    input_path = str(sys.argv[1]).strip() #1st-command line argument passed to script\n",
    "    output_path = str(sys.argv[2]).strip() #sys.argv: list of commandline arguments passed to .py\n",
    "                                           #argv: represents all the items, comes along via command-line i/p\n",
    "                                           #      array that holds the command line arguments \n",
    "                                           # counting starts at '0': which is name of program, '1': 1st argument\n",
    "                                           # strip(): returns a copy of 'string' - with both leading & trailing\n",
    "                                           #          characters removed; \n",
    "                                           # strip(x): removes string 'x' from the string\n",
    "    print(input_path)\n",
    "    print(output_path)\n",
    "    print(sys.argv[-2])\n",
    "    #calculate_prevalence_rate_by_location(input_path, output_path)\n",
    "    \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "9eeb38b2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>location_code</th>\n",
       "      <th>disease</th>\n",
       "      <th>prevalence</th>\n",
       "      <th>population</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>1277</td>\n",
       "      <td>18063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>1344</td>\n",
       "      <td>11123</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>603</td>\n",
       "      <td>11545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>12</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>1265</td>\n",
       "      <td>19140</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>6</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>1943</td>\n",
       "      <td>11811</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>8</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>584</td>\n",
       "      <td>9037</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1</td>\n",
       "      <td>pneumonia</td>\n",
       "      <td>1482</td>\n",
       "      <td>18063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1</td>\n",
       "      <td>cancer</td>\n",
       "      <td>344</td>\n",
       "      <td>18063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>4</td>\n",
       "      <td>cancer</td>\n",
       "      <td>351</td>\n",
       "      <td>11545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>1217</td>\n",
       "      <td>18063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>542</td>\n",
       "      <td>11123</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>4</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>474</td>\n",
       "      <td>11545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>cancer</td>\n",
       "      <td>1440</td>\n",
       "      <td>19140</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>2</td>\n",
       "      <td>cancer</td>\n",
       "      <td>1324</td>\n",
       "      <td>11123</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>5</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>947</td>\n",
       "      <td>26111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>6</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>1979</td>\n",
       "      <td>11811</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>12</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>1006</td>\n",
       "      <td>19140</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>6</td>\n",
       "      <td>pneumonia</td>\n",
       "      <td>1260</td>\n",
       "      <td>11811</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>8</td>\n",
       "      <td>pneumonia</td>\n",
       "      <td>1655</td>\n",
       "      <td>9037</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    location_code        disease  prevalence  population\n",
       "0               1       diabetes        1277       18063\n",
       "1               2       diabetes        1344       11123\n",
       "2               4       diabetes         603       11545\n",
       "3              12       diabetes        1265       19140\n",
       "4               6       diabetes        1943       11811\n",
       "5               8       diabetes         584        9037\n",
       "6               1      pneumonia        1482       18063\n",
       "7               1         cancer         344       18063\n",
       "8               4         cancer         351       11545\n",
       "9               1  heart disease        1217       18063\n",
       "10              2  heart disease         542       11123\n",
       "11              4  heart disease         474       11545\n",
       "12             12         cancer        1440       19140\n",
       "13              2         cancer        1324       11123\n",
       "14              5  heart disease         947       26111\n",
       "15              6  heart disease        1979       11811\n",
       "16             12  heart disease        1006       19140\n",
       "17              6      pneumonia        1260       11811\n",
       "18              8      pneumonia        1655        9037"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "id": "d35d2358",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>location_code</th>\n",
       "      <th>disease</th>\n",
       "      <th>population</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>18063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>11123</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>11545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>12</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>19140</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>6</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>11811</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>8</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>9037</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1</td>\n",
       "      <td>pneumonia</td>\n",
       "      <td>18063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1</td>\n",
       "      <td>cancer</td>\n",
       "      <td>18063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>4</td>\n",
       "      <td>cancer</td>\n",
       "      <td>11545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>18063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>11123</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>4</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>11545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>12</td>\n",
       "      <td>cancer</td>\n",
       "      <td>19140</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>2</td>\n",
       "      <td>cancer</td>\n",
       "      <td>11123</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>5</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>26111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>6</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>11811</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>12</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>19140</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>6</td>\n",
       "      <td>pneumonia</td>\n",
       "      <td>11811</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>8</td>\n",
       "      <td>pneumonia</td>\n",
       "      <td>9037</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    location_code        disease  population\n",
       "0               1       diabetes       18063\n",
       "1               2       diabetes       11123\n",
       "2               4       diabetes       11545\n",
       "3              12       diabetes       19140\n",
       "4               6       diabetes       11811\n",
       "5               8       diabetes        9037\n",
       "6               1      pneumonia       18063\n",
       "7               1         cancer       18063\n",
       "8               4         cancer       11545\n",
       "9               1  heart disease       18063\n",
       "10              2  heart disease       11123\n",
       "11              4  heart disease       11545\n",
       "12             12         cancer       19140\n",
       "13              2         cancer       11123\n",
       "14              5  heart disease       26111\n",
       "15              6  heart disease       11811\n",
       "16             12  heart disease       19140\n",
       "17              6      pneumonia       11811\n",
       "18              8      pneumonia        9037"
      ]
     },
     "execution_count": 93,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#cleaning\n",
    "data_clean =data.drop(['prevalence'], axis=1)\n",
    "data_clean\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "fe32250a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th colspan=\"4\" halign=\"left\">population</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>disease</th>\n",
       "      <th>cancer</th>\n",
       "      <th>diabetes</th>\n",
       "      <th>heart disease</th>\n",
       "      <th>pneumonia</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>location_code</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>18063.0</td>\n",
       "      <td>18063.0</td>\n",
       "      <td>18063.0</td>\n",
       "      <td>18063.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>11123.0</td>\n",
       "      <td>11123.0</td>\n",
       "      <td>11123.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>11545.0</td>\n",
       "      <td>11545.0</td>\n",
       "      <td>11545.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>26111.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>NaN</td>\n",
       "      <td>11811.0</td>\n",
       "      <td>11811.0</td>\n",
       "      <td>11811.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>NaN</td>\n",
       "      <td>9037.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9037.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>19140.0</td>\n",
       "      <td>19140.0</td>\n",
       "      <td>19140.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              population                                 \n",
       "disease           cancer diabetes heart disease pneumonia\n",
       "location_code                                            \n",
       "1                18063.0  18063.0       18063.0   18063.0\n",
       "2                11123.0  11123.0       11123.0       NaN\n",
       "4                11545.0  11545.0       11545.0       NaN\n",
       "5                    NaN      NaN       26111.0       NaN\n",
       "6                    NaN  11811.0       11811.0   11811.0\n",
       "8                    NaN   9037.0           NaN    9037.0\n",
       "12               19140.0  19140.0       19140.0       NaN"
      ]
     },
     "execution_count": 95,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#pivot df\n",
    "df_pivot= data_clean.pivot(index='location_code', columns ='disease')\n",
    "#d_groupby_location = df_pivot.groupby('location_code')['population']\n",
    "df_new= pd.DataFrame(df_pivot) #columns=['location_code', 'disease_count'])\n",
    "#['location_code','cancer','diabetes','heart disease','pneumonia']\n",
    "#df_groupby_location['mean']= df_groupby_location.agg(['mean'])\n",
    "#df_groupby_location['mean']\n",
    "df_new\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "id": "c88e646c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              population                                  \n",
      "disease           cancer  diabetes heart disease pneumonia\n",
      "location_code                                             \n",
      "1               6.514025  6.514025      6.514025  6.514025\n",
      "2               4.011266  4.011266      4.011266       NaN\n",
      "4               4.163451  4.163451      4.163451       NaN\n",
      "5                    NaN       NaN      9.416360       NaN\n",
      "6                    NaN  4.259378      4.259378  4.259378\n",
      "8                    NaN  3.258996           NaN  3.258996\n",
      "12              6.902421  6.902421      6.902421       NaN\n"
     ]
    }
   ],
   "source": [
    "population_sum = data_clean.population.sum()\n",
    "#population_sum\n",
    "\n",
    "print(percentage)\n",
    "\n",
    "def dfn(df_new):\n",
    "    if df_new['disease']!= NaN:\n",
    "        percentage = ((df_new)/population_sum)*100\n",
    "    else:\n",
    "        percentage = 0\n",
    "    return percentage\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 127,
   "id": "d617ba5c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th colspan=\"4\" halign=\"left\">population</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>disease</th>\n",
       "      <th>cancer</th>\n",
       "      <th>diabetes</th>\n",
       "      <th>heart disease</th>\n",
       "      <th>pneumonia</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>location_code</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>6.514025</td>\n",
       "      <td>6.514025</td>\n",
       "      <td>6.514025</td>\n",
       "      <td>6.514025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>4.011266</td>\n",
       "      <td>4.011266</td>\n",
       "      <td>4.011266</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4.163451</td>\n",
       "      <td>4.163451</td>\n",
       "      <td>4.163451</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>9.416360</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>4.259378</td>\n",
       "      <td>4.259378</td>\n",
       "      <td>4.259378</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>3.258996</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>3.258996</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>6.902421</td>\n",
       "      <td>6.902421</td>\n",
       "      <td>6.902421</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              population                                  \n",
       "disease           cancer  diabetes heart disease pneumonia\n",
       "location_code                                             \n",
       "1               6.514025  6.514025      6.514025  6.514025\n",
       "2               4.011266  4.011266      4.011266  0.000000\n",
       "4               4.163451  4.163451      4.163451  0.000000\n",
       "5               0.000000  0.000000      9.416360  0.000000\n",
       "6               0.000000  4.259378      4.259378  4.259378\n",
       "8               0.000000  3.258996      0.000000  3.258996\n",
       "12              6.902421  6.902421      6.902421  0.000000"
      ]
     },
     "execution_count": 127,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#d_group_sum = d_groupby_location.sum()\n",
    "#d_group_sum\n",
    "df_final = percentage.fillna(int(0))\n",
    "df_final"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 133,
   "id": "29f87c4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_final.to_csv('file_name.csv')\n",
    "#with open('output.csv', 'w') as f:\n",
    " #   writer = csv.writer(f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "id": "9867f048",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>population</th>\n",
       "      <th>population.1</th>\n",
       "      <th>population.2</th>\n",
       "      <th>population.3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>disease</td>\n",
       "      <td>cancer</td>\n",
       "      <td>diabetes</td>\n",
       "      <td>heart disease</td>\n",
       "      <td>pneumonia</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>location_code</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>6.514024825636327</td>\n",
       "      <td>6.514024825636327</td>\n",
       "      <td>6.514024825636327</td>\n",
       "      <td>6.514024825636327</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2</td>\n",
       "      <td>4.011266020902003</td>\n",
       "      <td>4.011266020902003</td>\n",
       "      <td>4.011266020902003</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>4.163451066377203</td>\n",
       "      <td>4.163451066377203</td>\n",
       "      <td>4.163451066377203</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>9.416359531760515</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.259378132956357</td>\n",
       "      <td>4.259378132956357</td>\n",
       "      <td>4.259378132956357</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.25899586720232</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.25899586720232</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>12</td>\n",
       "      <td>6.90242125686095</td>\n",
       "      <td>6.90242125686095</td>\n",
       "      <td>6.90242125686095</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0         population       population.1       population.2  \\\n",
       "0        disease             cancer           diabetes      heart disease   \n",
       "1  location_code                NaN                NaN                NaN   \n",
       "2              1  6.514024825636327  6.514024825636327  6.514024825636327   \n",
       "3              2  4.011266020902003  4.011266020902003  4.011266020902003   \n",
       "4              4  4.163451066377203  4.163451066377203  4.163451066377203   \n",
       "5              5                0.0                0.0  9.416359531760515   \n",
       "6              6                0.0  4.259378132956357  4.259378132956357   \n",
       "7              8                0.0   3.25899586720232                0.0   \n",
       "8             12   6.90242125686095   6.90242125686095   6.90242125686095   \n",
       "\n",
       "        population.3  \n",
       "0          pneumonia  \n",
       "1                NaN  \n",
       "2  6.514024825636327  \n",
       "3                0.0  \n",
       "4                0.0  \n",
       "5                0.0  \n",
       "6  4.259378132956357  \n",
       "7   3.25899586720232  \n",
       "8                0.0  "
      ]
     },
     "execution_count": 134,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_saved_file = pd.read_csv('file_name.csv')\n",
    "df_saved_file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3f99b529",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
